# [51. Nçš‡å](https://leetcode-cn.com/problems/n-queens/)

---

éš¾åº¦ `å›°éš¾` | æ ‡ç­¾ `å›æº¯ç®—æ³•`  | ä¸ªäººæ ‡ç­¾ ğŸŒ€ | è·èµ `401`

---

## Description

<style>
section pre{
    background-color: #eee;
    border: 1px solid #ddd;
    padding:10px;
    border-radius: 5px;
}
</style>
<section>
<p><em>n&nbsp;</em>çš‡åé—®é¢˜ç ”ç©¶çš„æ˜¯å¦‚ä½•å°† <em>n</em>&nbsp;ä¸ªçš‡åæ”¾ç½®åœ¨ <em>n</em>Ã—<em>n</em> çš„æ£‹ç›˜ä¸Šï¼Œå¹¶ä¸”ä½¿çš‡åå½¼æ­¤ä¹‹é—´ä¸èƒ½ç›¸äº’æ”»å‡»ã€‚</p>
<p><img src="https://assets.leetcode-cn.com/aliyun-lc-upload/uploads/2018/10/12/8-queens.png"></p>
<p><small>ä¸Šå›¾ä¸º 8 çš‡åé—®é¢˜çš„ä¸€ç§è§£æ³•ã€‚</small></p>
<p>ç»™å®šä¸€ä¸ªæ•´æ•° <em>n</em>ï¼Œè¿”å›æ‰€æœ‰ä¸åŒçš„&nbsp;<em>n&nbsp;</em>çš‡åé—®é¢˜çš„è§£å†³æ–¹æ¡ˆã€‚</p>
<p>æ¯ä¸€ç§è§£æ³•åŒ…å«ä¸€ä¸ªæ˜ç¡®çš„&nbsp;<em>n</em> çš‡åé—®é¢˜çš„æ£‹å­æ”¾ç½®æ–¹æ¡ˆï¼Œè¯¥æ–¹æ¡ˆä¸­ <code>'Q'</code> å’Œ <code>'.'</code> åˆ†åˆ«ä»£è¡¨äº†çš‡åå’Œç©ºä½ã€‚</p>
<p><strong>ç¤ºä¾‹:</strong></p>
<pre><strong>è¾“å…¥:</strong> 4
<strong>è¾“å‡º:</strong> [
 [".Q..",  // è§£æ³• 1
  "...Q",
  "Q...",
  "..Q."],
 ["..Q.",  // è§£æ³• 2
  "Q...",
  "...Q",
  ".Q.."]
]
<strong>è§£é‡Š:</strong> 4 çš‡åé—®é¢˜å­˜åœ¨ä¸¤ä¸ªä¸åŒçš„è§£æ³•ã€‚
</pre>
<p>&nbsp;</p>
<p><strong>æç¤ºï¼š</strong></p>
<ul>
	<li><strong>çš‡å</strong>ï¼Œæ˜¯<a href="https://baike.baidu.com/item/%E5%9B%BD%E9%99%85%E8%B1%A1%E6%A3%8B">å›½é™…è±¡æ£‹</a>ä¸­çš„æ£‹å­ï¼Œæ„å‘³ç€<a href="https://baike.baidu.com/item/%E5%9B%BD%E7%8E%8B">å›½ç‹</a>çš„å¦»å­ã€‚çš‡ååªåšä¸€ä»¶äº‹ï¼Œé‚£å°±æ˜¯â€œ<a href="https://baike.baidu.com/item/%E5%90%83%E5%AD%90">åƒå­</a>â€ã€‚å½“å¥¹é‡è§å¯ä»¥åƒçš„æ£‹å­æ—¶ï¼Œå°±è¿…é€Ÿå†²ä¸Šå»åƒæ‰æ£‹å­ã€‚å½“ç„¶ï¼Œå¥¹æ¨ªã€ç«–ã€æ–œéƒ½å¯èµ°ä¸€åˆ°ä¸ƒæ­¥ï¼Œå¯è¿›å¯é€€ã€‚ï¼ˆå¼•ç”¨è‡ª <a href="https://baike.baidu.com/item/%E7%9A%87%E5%90%8E/15860305?fr=aladdin">ç™¾åº¦ç™¾ç§‘ - çš‡å</a> ï¼‰</li>
</ul>
</section>

## My Solution

```python
class Solution:
    def solveNQueens(self, n: int) -> List[List[str]]:
        if n==1:return [['Q']]
        res=[]
        pane=[[0 for x in range(n)] for x in range(n)]

        def modPane(row,col,n,val):
            i=1
            r=i+row
            while r<n:
                pane[r][col]+=val
                if 0<=col-i: pane[r][col-i]+=val
                if col+i<n: pane[r][col+i]+=val
                i+=1
                r+=1

        def putLine(sol,row,n,pre_col):
            for col in range(n):
                if pane[row][col]==0: 
                    modPane(row,col,n,1)
                    sol.append(col)
                    if row==n-1:
                        res.append(sol.copy())
                        sol.pop()
                        sol.pop()
                        modPane(row-1,pre_col,n,-1)
                        return True
                    else: 
                        if not putLine(sol,row+1,n,col):
                            sol.pop()
                            modPane(row,col,n,-1)
            return False
        
        putLine([],0,n,0)
        return [["."*x+"Q"+"."*(n-1-x) for x in sol] for sol in res]
```

- æˆ‘è ¢äº†ï¼Œå…¶å®ä¸ç”¨ä¸€ä¸ª$N\times N$çš„çŸ©é˜µæ¥å­˜å¯æ”¾ä½ç½®çš„çŠ¶æ€çš„ï¼Œå…³äºæ–œå¯¹è§’çº¿çš„çŠ¶æ€æ ‡è®°ï¼Œå¯¹äºä¸€ä¸ªæ ¼å­$(i,j)$ä»–çš„æ­£å¯¹è§’çº¿ä¸Šçš„æ ¼å­ä½ç½®åæ ‡ä¹‹å’Œæ˜¯å¸¸æ•°$i+j$ï¼Œåå¯¹è§’çº¿æ ¼å­ä½ç½®åæ ‡ä¹‹å·®æ˜¯å¸¸æ•°$i-j$ï¼Œæ¯æ¬¡åˆ¤æ–­å ç”¨çŠ¶æ€æ—¶ï¼Œç”¨hash mapè®°å½•è¿™äº›å¸¸æ•°å³å¯ï¼Œä¸€å…±éœ€è¦ä¸‰ç»„hash mapï¼Œåˆ†åˆ«è®°å½•ç«–å‘ã€æ­£æ–œå‘ã€åæ–œå‘çš„å ç”¨çŠ¶æ€å³å¯ã€‚
- å…ˆè¿›è¡Œä¸€äº›ç»“æ„æ€§çš„ä¼˜åŒ–ï¼Œå»é™¤ä¸å¿…è¦çš„ç»“æ„

```python
class Solution:
    def solveNQueens(self, n: int) -> List[List[str]]:
        res=[]
        pane=[[0 for x in range(n)] for x in range(n)]

        def modPane(row,col,n,val):
            i=1
            r=i+row
            while r<n:
                pane[r][col]+=val
                if 0<=col-i: pane[r][col-i]+=val
                if col+i<n: pane[r][col+i]+=val
                i+=1
                r+=1

        def putLine(sol,row,n):
            if row==n:
                res.append(sol[:])
            for col in range(n):
                if col not in sol and pane[row][col]==0: 
                    modPane(row,col,n,1)
                    sol.append(col)
                    putLine(sol,row+1,n)
                    sol.pop()
                    modPane(row,col,n,-1)
        
        putLine([],0,n)
        return [["."*x+"Q"+"."*(n-1-x) for x in sol] for sol in res]
```

- ç„¶åä¼˜åŒ–çŠ¶æ€è®°å½•æ•°ç»„ï¼ŒåŸæ¥çš„æ–¹æ³•å¤ªå•°å—¦äº†ã€‚

```python
class Solution:
    def solveNQueens(self, n: int) -> List[List[str]]:
        def putLine(sol,row):
            if row==n:
                res.append(sol[:])
            for col in range(n):
                d1=row+col
                d2=row-col
                if col not in sol and diag1[d1] and diag2[d2]: 
                    diag1[d1],diag2[d2]=False,False
                    sol.append(col)
                    putLine(sol,row+1)
                    sol.pop()
                    diag1[d1],diag2[d2]=True,True

        diag1=[True for x in range(2*n-1)]
        diag2=[True for x in range(2*n-1)]
        res=[]
        putLine([],0)
        return [["."*x+"Q"+"."*(n-1-x) for x in sol] for sol in res]
```

